<!DOCTYPE html>
<html>
<head>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
  <canvas id="myChart"></canvas>

  <script>
    var ctx = document.getElementById('myChart').getContext('2d');
    var myChart = new Chart(ctx, {
      type: 'line',
      data: {
        labels: [],
        datasets: [{
          label: 'Temperature (Â°C)',
          data: [],
          borderColor: 'blue',
          fill: false
        }]
      },
      options: {
        responsive: true,
        scales: {
          x: { 
            type: 'time', 
            time: { unit: 'minute' }, 
            title: { display: true, text: 'Time' } 
          },
          y: { 
            beginAtZero: false, 
            title: { display: true, text: 'Temperature (Â°C)' } 
          }
        }
      }
    });

    // ğŸ“Œ 5åˆ†ã”ã¨ã«ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã—ã¦ã‚°ãƒ©ãƒ•ã‚’æ›´æ–°
    function updateChart() {
      fetch('YOUR_GAS_WEB_APP_URL')  // Google Apps Script ã® Web ã‚¢ãƒ—ãƒª URL ã‚’è¨­å®š
        .then(response => response.json())
        .then(data => {
          // ğŸ“Œ æœ€æ–°ã® 278 å€‹ã®ãƒ‡ãƒ¼ã‚¿ã ã‘å–å¾—
          var latestData = data.slice(-278);

          // ğŸ“Œ timestamp ã‚’é©åˆ‡ãªãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã«å¤‰æ›
          var labels = latestData.map(d => new Date(d.timestamp).toLocaleTimeString());
          var temperatures = latestData.map(d => d.temperature);

          // ğŸ“Œ Chart.js ã«ãƒ‡ãƒ¼ã‚¿ã‚’é©ç”¨
          myChart.data.labels = labels;
          myChart.data.datasets[0].data = temperatures;
          myChart.update();
        })
        .catch(error => console.error('Error fetching data:', error));
    }

    // ğŸ”„ åˆå›å®Ÿè¡Œ
    updateChart();

    // ğŸ”„ 5åˆ†ã”ã¨ã«è‡ªå‹•æ›´æ–°ï¼ˆ300000ãƒŸãƒªç§’ = 5åˆ†ï¼‰
    setInterval(updateChart, 300000);
  </script>
</body>
</html>
